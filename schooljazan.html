<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุจุฑูุงูุฌ ูุชุงุจุนุฉ ุฎุฑูุทุฉ ููุงุชุฌ ุงูุชุนูู - ูุฏุฑุณุฉ ุงูุตูุงุฑูุฉ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'primary': '#07A869',
                        'secondary': '#3D7EB9',
                        'accent': '#0DA9A6',
                        'dark': '#15445A',
                        'gold': '#C1B48A',
                        'custom-gray': '#C2C1C1'
                    }
                }
            }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700&display=swap');
        
        * {
            font-family: 'Tajawal', sans-serif;
        }
        
        @media print {
            .no-print { display: none !important; }
            body { background: white !important; }
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- Header -->
    <header class="bg-dark text-white p-4 shadow-lg">
        <div class="container mx-auto">
            <h1 class="text-2xl font-bold text-center">ุจุฑูุงูุฌ ูุชุงุจุนุฉ ุฎุฑูุทุฉ ููุงุชุฌ ุงูุชุนูู</h1>
            <p class="text-center text-lg mt-2">ูุฏุฑุณุฉ ุงุจุชุฏุงุฆูุฉ ููุชูุณุทุฉ ุงูุตูุงุฑูุฉ - ุฌุงุฒุงู</p>
            <div class="text-center mt-2">
                <span id="current-date" class="text-sm bg-gold text-dark px-3 py-1 rounded"></span>
                <span id="current-time" class="text-sm bg-secondary px-3 py-1 rounded mr-2"></span>
            </div>
        </div>
    </header>

    <!-- Navigation -->
    <nav class="bg-secondary text-white p-4 no-print">
        <div class="container mx-auto flex justify-center space-x-4 space-x-reverse">
            <button onclick="showSection('elementary')" id="elementaryBtn" class="px-6 py-2 rounded-lg bg-primary text-white hover:bg-green-600 transition-colors">ุงููุฑุญูุฉ ุงูุงุจุชุฏุงุฆูุฉ</button>
            <button onclick="showSection('middle')" id="middleBtn" class="px-6 py-2 rounded-lg bg-accent text-white hover:bg-teal-600 transition-colors">ุงููุฑุญูุฉ ุงููุชูุณุทุฉ</button>
            <button onclick="showSection('admin')" id="adminBtn" class="px-6 py-2 rounded-lg bg-gold text-dark hover:bg-yellow-600 transition-colors">ููุญุฉ ุงููุฏูุฑ</button>
        </div>
    </nav>

    <!-- Elementary Section -->
    <div id="elementarySection" class="container mx-auto p-6">
        <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
            <h2 class="text-2xl font-bold text-primary mb-6 text-center">ุฎุฑูุทุฉ ููุงุชุฌ ุงูุชุนูู - ุงููุฑุญูุฉ ุงูุงุจุชุฏุงุฆูุฉ</h2>
            
            <!-- Basic Information -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
                <div>
                    <label class="block text-dark font-semibold mb-2">ุงููุงุฏุฉ</label>
                    <select id="elementary-subject" class="w-full p-3 border border-secondary rounded-lg focus:outline-none focus:ring-2 focus:ring-primary">
                        <option value="">ุงุฎุชุฑ ุงููุงุฏุฉ</option>
                        <option value="ุงููุบุฉ ุงูุนุฑุจูุฉ">ุงููุบุฉ ุงูุนุฑุจูุฉ</option>
                        <option value="ุงูุฑูุงุถูุงุช">ุงูุฑูุงุถูุงุช</option>
                        <option value="ุงูุนููู">ุงูุนููู</option>
                        <option value="ุงูุชุฑุจูุฉ ุงูุฅุณูุงููุฉ">ุงูุชุฑุจูุฉ ุงูุฅุณูุงููุฉ</option>
                        <option value="ุงูุชุฑุจูุฉ ุงูุงุฌุชูุงุนูุฉ">ุงูุชุฑุจูุฉ ุงูุงุฌุชูุงุนูุฉ</option>
                    </select>
                </div>
                <div>
                    <label class="block text-dark font-semibold mb-2">ุงูุตู</label>
                    <select id="elementary-grade" class="w-full p-3 border border-secondary rounded-lg focus:outline-none focus:ring-2 focus:ring-primary">
                        <option value="">ุงุฎุชุฑ ุงูุตู</option>
                        <option value="ุงูุฃูู">ุงูุฃูู</option>
                        <option value="ุงูุซุงูู">ุงูุซุงูู</option>
                        <option value="ุงูุซุงูุซ">ุงูุซุงูุซ</option>
                        <option value="ุงูุฑุงุจุน">ุงูุฑุงุจุน</option>
                        <option value="ุงูุฎุงูุณ">ุงูุฎุงูุณ</option>
                        <option value="ุงูุณุงุฏุณ">ุงูุณุงุฏุณ</option>
                    </select>
                </div>
                <div>
                    <label class="block text-dark font-semibold mb-2">ุงููุตู ุงูุฏุฑุงุณู</label>
                    <select id="elementary-semester" class="w-full p-3 border border-secondary rounded-lg focus:outline-none focus:ring-2 focus:ring-primary">
                        <option value="">ุงุฎุชุฑ ุงููุตู</option>
                        <option value="ุงูุฃูู">ุงูุฃูู</option>
                        <option value="ุงูุซุงูู">ุงูุซุงูู</option>
                        <option value="ุงูุซุงูุซ">ุงูุซุงูุซ</option>
                    </select>
                </div>
                <div>
                    <label class="block text-dark font-semibold mb-2">ุงุณู ุงููุนูู/ุงููุนููุฉ</label>
                    <select id="elementary-teacher" class="w-full p-3 border border-secondary rounded-lg focus:outline-none focus:ring-2 focus:ring-primary">
                        <option value="">ุงุฎุชุฑ ุงููุนูู/ุงููุนููุฉ</option>
                    </select>
                </div>
            </div>

            <!-- Date Information -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6 p-4 bg-gray-50 rounded-lg">
                <div>
                    <label class="block text-dark font-semibold mb-2">ุชุงุฑูุฎ ุฅูุดุงุก ุงูุฎุฑูุทุฉ</label>
                    <input type="date" id="elementary-creation-date" class="w-full p-3 border border-secondary rounded-lg focus:outline-none focus:ring-2 focus:ring-primary">
                </div>
                <div>
                    <label class="block text-dark font-semibold mb-2">ุชุงุฑูุฎ ุขุฎุฑ ุชุญุฏูุซ</label>
                    <input type="date" id="elementary-update-date" class="w-full p-3 border border-secondary rounded-lg focus:outline-none focus:ring-2 focus:ring-primary" readonly>
                </div>
            </div>

            <!-- Learning Map Sections -->
            <div class="space-y-6">
                <!-- Units -->
                <div class="bg-gray-50 p-4 rounded-lg">
                    <h3 class="text-lg font-bold text-secondary mb-3">ุงููุญุฏุงุช</h3>
                    <div id="elementary-units-container">
                        <div class="flex gap-2 mb-2">
                            <input type="text" class="flex-1 p-2 border border-gray-300 rounded" placeholder="ุฃุฏุฎู ุงููุญุฏุฉ">
                            <button onclick="addField('elementary-units-container')" class="px-4 py-2 bg-primary text-white rounded hover:bg-green-600">ุฅุถุงูุฉ</button>
                        </div>
                    </div>
                </div>

                <!-- Learning Objectives -->
                <div class="bg-gray-50 p-4 rounded-lg">
                    <h3 class="text-lg font-bold text-secondary mb-3">ุงูุฃูุฏุงู ุงูุชุนููููุฉ</h3>
                    <div id="elementary-objectives-container">
                        <div class="flex gap-2 mb-2">
                            <input type="text" class="flex-1 p-2 border border-gray-300 rounded" placeholder="ุฃุฏุฎู ุงููุฏู ุงูุชุนูููู">
                            <button onclick="addField('elementary-objectives-container')" class="px-4 py-2 bg-primary text-white rounded hover:bg-green-600">ุฅุถุงูุฉ</button>
                        </div>
                    </div>
                </div>

                <!-- Content -->
                <div class="bg-gray-50 p-4 rounded-lg">
                    <h3 class="text-lg font-bold text-secondary mb-3">ุงููุญุชูู</h3>
                    <div id="elementary-content-container">
                        <div class="flex gap-2 mb-2">
                            <input type="text" class="flex-1 p-2 border border-gray-300 rounded" placeholder="ุฃุฏุฎู ุงููุญุชูู">
                            <button onclick="addField('elementary-content-container')" class="px-4 py-2 bg-primary text-white rounded hover:bg-green-600">ุฅุถุงูุฉ</button>
                        </div>
                    </div>
                </div>

                <!-- Learning Outcomes -->
                <div class="bg-gray-50 p-4 rounded-lg">
                    <h3 class="text-lg font-bold text-secondary mb-3">ููุงุชุฌ ุงูุชุนูู</h3>
                    <div id="elementary-outcomes-container">
                        <div class="space-y-2 mb-2">
                            <input type="text" class="w-full p-2 border border-gray-300 rounded" placeholder="ุฃุฏุฎู ูุงุชุฌ ุงูุชุนูู">
                            <input type="text" class="w-full p-2 border border-gray-300 rounded" placeholder="ุฃุฏุฎู ุงูุดุงูุฏ">
                            <button onclick="addOutcomeField('elementary-outcomes-container')" class="px-4 py-2 bg-primary text-white rounded hover:bg-green-600">ุฅุถุงูุฉ</button>
                        </div>
                    </div>
                </div>

                <!-- Educational Activities -->
                <div class="bg-gray-50 p-4 rounded-lg">
                    <h3 class="text-lg font-bold text-secondary mb-3">ุงูุฃูุดุทุฉ ุงูุชุนููููุฉ</h3>
                    <div id="elementary-activities-container">
                        <div class="space-y-2 mb-2">
                            <input type="text" class="w-full p-2 border border-gray-300 rounded" placeholder="ุฃุฏุฎู ุงููุดุงุท ุงูุชุนูููู">
                            <input type="text" class="w-full p-2 border border-gray-300 rounded" placeholder="ุฃุฏุฎู ุงูุดุงูุฏ">
                            <button onclick="addOutcomeField('elementary-activities-container')" class="px-4 py-2 bg-primary text-white rounded hover:bg-green-600">ุฅุถุงูุฉ</button>
                        </div>
                    </div>
                </div>

                <!-- Teaching Methods -->
                <div class="bg-gray-50 p-4 rounded-lg">
                    <h3 class="text-lg font-bold text-secondary mb-3">ุฃุณุงููุจ ูุทุฑู ุงูุชุฏุฑูุณ</h3>
                    <div id="elementary-methods-container">
                        <div class="space-y-2 mb-2">
                            <input type="text" class="w-full p-2 border border-gray-300 rounded" placeholder="ุฃุฏุฎู ุฃุณููุจ ุงูุชุฏุฑูุณ">
                            <input type="text" class="w-full p-2 border border-gray-300 rounded" placeholder="ุฃุฏุฎู ุงูุดุงูุฏ">
                            <button onclick="addOutcomeField('elementary-methods-container')" class="px-4 py-2 bg-primary text-white rounded hover:bg-green-600">ุฅุถุงูุฉ</button>
                        </div>
                    </div>
                </div>

                <!-- Assessment Tools -->
                <div class="bg-gray-50 p-4 rounded-lg">
                    <h3 class="text-lg font-bold text-secondary mb-3">ุฃุณุงููุจ ูุฃุฏูุงุช ุชูููู ููุงุชุฌ ุงูุชุนูู</h3>
                    <div id="elementary-assessment-container">
                        <div class="space-y-2 mb-2">
                            <input type="text" class="w-full p-2 border border-gray-300 rounded" placeholder="ุฃุฏุฎู ุฃุฏุงุฉ ุงูุชูููู">
                            <input type="text" class="w-full p-2 border border-gray-300 rounded" placeholder="ุฃุฏุฎู ุงูุดุงูุฏ">
                            <button onclick="addOutcomeField('elementary-assessment-container')" class="px-4 py-2 bg-primary text-white rounded hover:bg-green-600">ุฅุถุงูุฉ</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 space-x-reverse mt-8 no-print">
                <button onclick="saveData('elementary')" class="px-6 py-3 bg-primary text-white rounded-lg hover:bg-green-600 transition-colors">ุญูุธ ุงูุจูุงูุงุช</button>
                <button onclick="printSection('elementarySection')" class="px-6 py-3 bg-secondary text-white rounded-lg hover:bg-blue-600 transition-colors">ุทุจุงุนุฉ</button>
                <button onclick="exportToWord('elementary')" class="px-6 py-3 bg-accent text-white rounded-lg hover:bg-teal-600 transition-colors">ุชุตุฏูุฑ ุฅูู Word</button>
            </div>
        </div>
    </div>

    <!-- Middle School Section -->
    <div id="middleSection" class="container mx-auto p-6 hidden">
        <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
            <h2 class="text-2xl font-bold text-accent mb-6 text-center">ุฎุฑูุทุฉ ููุงุชุฌ ุงูุชุนูู - ุงููุฑุญูุฉ ุงููุชูุณุทุฉ</h2>
            
            <!-- Basic Information -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
                <div>
                    <label class="block text-dark font-semibold mb-2">ุงููุงุฏุฉ</label>
                    <select id="middle-subject" class="w-full p-3 border border-accent rounded-lg focus:outline-none focus:ring-2 focus:ring-accent">
                        <option value="">ุงุฎุชุฑ ุงููุงุฏุฉ</option>
                        <option value="ุงููุบุฉ ุงูุนุฑุจูุฉ">ุงููุบุฉ ุงูุนุฑุจูุฉ</option>
                        <option value="ุงูุฑูุงุถูุงุช">ุงูุฑูุงุถูุงุช</option>
                        <option value="ุงูุนููู">ุงูุนููู</option>
                        <option value="ุงูุชุฑุจูุฉ ุงูุฅุณูุงููุฉ">ุงูุชุฑุจูุฉ ุงูุฅุณูุงููุฉ</option>
                        <option value="ุงูุฏุฑุงุณุงุช ุงูุงุฌุชูุงุนูุฉ">ุงูุฏุฑุงุณุงุช ุงูุงุฌุชูุงุนูุฉ</option>
                        <option value="ุงููุบุฉ ุงูุฅูุฌููุฒูุฉ">ุงููุบุฉ ุงูุฅูุฌููุฒูุฉ</option>
                    </select>
                </div>
                <div>
                    <label class="block text-dark font-semibold mb-2">ุงูุตู</label>
                    <select id="middle-grade" class="w-full p-3 border border-accent rounded-lg focus:outline-none focus:ring-2 focus:ring-accent">
                        <option value="">ุงุฎุชุฑ ุงูุตู</option>
                        <option value="ุงูุฃูู ุงููุชูุณุท">ุงูุฃูู ุงููุชูุณุท</option>
                        <option value="ุงูุซุงูู ุงููุชูุณุท">ุงูุซุงูู ุงููุชูุณุท</option>
                        <option value="ุงูุซุงูุซ ุงููุชูุณุท">ุงูุซุงูุซ ุงููุชูุณุท</option>
                    </select>
                </div>
                <div>
                    <label class="block text-dark font-semibold mb-2">ุงููุตู ุงูุฏุฑุงุณู</label>
                    <select id="middle-semester" class="w-full p-3 border border-accent rounded-lg focus:outline-none focus:ring-2 focus:ring-accent">
                        <option value="">ุงุฎุชุฑ ุงููุตู</option>
                        <option value="ุงูุฃูู">ุงูุฃูู</option>
                        <option value="ุงูุซุงูู">ุงูุซุงูู</option>
                        <option value="ุงูุซุงูุซ">ุงูุซุงูุซ</option>
                    </select>
                </div>
                <div>
                    <label class="block text-dark font-semibold mb-2">ุงุณู ุงููุนูู/ุงููุนููุฉ</label>
                    <select id="middle-teacher" class="w-full p-3 border border-accent rounded-lg focus:outline-none focus:ring-2 focus:ring-accent">
                        <option value="">ุงุฎุชุฑ ุงููุนูู/ุงููุนููุฉ</option>
                    </select>
                </div>
            </div>

            <!-- Date Information -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6 p-4 bg-gray-50 rounded-lg">
                <div>
                    <label class="block text-dark font-semibold mb-2">ุชุงุฑูุฎ ุฅูุดุงุก ุงูุฎุฑูุทุฉ</label>
                    <input type="date" id="middle-creation-date" class="w-full p-3 border border-accent rounded-lg focus:outline-none focus:ring-2 focus:ring-accent">
                </div>
                <div>
                    <label class="block text-dark font-semibold mb-2">ุชุงุฑูุฎ ุขุฎุฑ ุชุญุฏูุซ</label>
                    <input type="date" id="middle-update-date" class="w-full p-3 border border-accent rounded-lg focus:outline-none focus:ring-2 focus:ring-accent" readonly>
                </div>
            </div>

            <!-- Learning Map Sections (Similar structure as elementary) -->
            <div class="space-y-6">
                <!-- Units -->
                <div class="bg-gray-50 p-4 rounded-lg">
                    <h3 class="text-lg font-bold text-accent mb-3">ุงููุญุฏุงุช</h3>
                    <div id="middle-units-container">
                        <div class="flex gap-2 mb-2">
                            <input type="text" class="flex-1 p-2 border border-gray-300 rounded" placeholder="ุฃุฏุฎู ุงููุญุฏุฉ">
                            <button onclick="addField('middle-units-container')" class="px-4 py-2 bg-accent text-white rounded hover:bg-teal-600">ุฅุถุงูุฉ</button>
                        </div>
                    </div>
                </div>

                <!-- Learning Objectives -->
                <div class="bg-gray-50 p-4 rounded-lg">
                    <h3 class="text-lg font-bold text-accent mb-3">ุงูุฃูุฏุงู ุงูุชุนููููุฉ</h3>
                    <div id="middle-objectives-container">
                        <div class="flex gap-2 mb-2">
                            <input type="text" class="flex-1 p-2 border border-gray-300 rounded" placeholder="ุฃุฏุฎู ุงููุฏู ุงูุชุนูููู">
                            <button onclick="addField('middle-objectives-container')" class="px-4 py-2 bg-accent text-white rounded hover:bg-teal-600">ุฅุถุงูุฉ</button>
                        </div>
                    </div>
                </div>

                <!-- Content -->
                <div class="bg-gray-50 p-4 rounded-lg">
                    <h3 class="text-lg font-bold text-accent mb-3">ุงููุญุชูู</h3>
                    <div id="middle-content-container">
                        <div class="flex gap-2 mb-2">
                            <input type="text" class="flex-1 p-2 border border-gray-300 rounded" placeholder="ุฃุฏุฎู ุงููุญุชูู">
                            <button onclick="addField('middle-content-container')" class="px-4 py-2 bg-accent text-white rounded hover:bg-teal-600">ุฅุถุงูุฉ</button>
                        </div>
                    </div>
                </div>

                <!-- Learning Outcomes -->
                <div class="bg-gray-50 p-4 rounded-lg">
                    <h3 class="text-lg font-bold text-accent mb-3">ููุงุชุฌ ุงูุชุนูู</h3>
                    <div id="middle-outcomes-container">
                        <div class="space-y-2 mb-2">
                            <input type="text" class="w-full p-2 border border-gray-300 rounded" placeholder="ุฃุฏุฎู ูุงุชุฌ ุงูุชุนูู">
                            <input type="text" class="w-full p-2 border border-gray-300 rounded" placeholder="ุฃุฏุฎู ุงูุดุงูุฏ">
                            <button onclick="addOutcomeField('middle-outcomes-container')" class="px-4 py-2 bg-accent text-white rounded hover:bg-teal-600">ุฅุถุงูุฉ</button>
                        </div>
                    </div>
                </div>

                <!-- Educational Activities -->
                <div class="bg-gray-50 p-4 rounded-lg">
                    <h3 class="text-lg font-bold text-accent mb-3">ุงูุฃูุดุทุฉ ุงูุชุนููููุฉ</h3>
                    <div id="middle-activities-container">
                        <div class="space-y-2 mb-2">
                            <input type="text" class="w-full p-2 border border-gray-300 rounded" placeholder="ุฃุฏุฎู ุงููุดุงุท ุงูุชุนูููู">
                            <input type="text" class="w-full p-2 border border-gray-300 rounded" placeholder="ุฃุฏุฎู ุงูุดุงูุฏ">
                            <button onclick="addOutcomeField('middle-activities-container')" class="px-4 py-2 bg-accent text-white rounded hover:bg-teal-600">ุฅุถุงูุฉ</button>
                        </div>
                    </div>
                </div>

                <!-- Teaching Methods -->
                <div class="bg-gray-50 p-4 rounded-lg">
                    <h3 class="text-lg font-bold text-accent mb-3">ุฃุณุงููุจ ูุทุฑู ุงูุชุฏุฑูุณ</h3>
                    <div id="middle-methods-container">
                        <div class="space-y-2 mb-2">
                            <input type="text" class="w-full p-2 border border-gray-300 rounded" placeholder="ุฃุฏุฎู ุฃุณููุจ ุงูุชุฏุฑูุณ">
                            <input type="text" class="w-full p-2 border border-gray-300 rounded" placeholder="ุฃุฏุฎู ุงูุดุงูุฏ">
                            <button onclick="addOutcomeField('middle-methods-container')" class="px-4 py-2 bg-accent text-white rounded hover:bg-teal-600">ุฅุถุงูุฉ</button>
                        </div>
                    </div>
                </div>

                <!-- Assessment Tools -->
                <div class="bg-gray-50 p-4 rounded-lg">
                    <h3 class="text-lg font-bold text-accent mb-3">ุฃุณุงููุจ ูุฃุฏูุงุช ุชูููู ููุงุชุฌ ุงูุชุนูู</h3>
                    <div id="middle-assessment-container">
                        <div class="space-y-2 mb-2">
                            <input type="text" class="w-full p-2 border border-gray-300 rounded" placeholder="ุฃุฏุฎู ุฃุฏุงุฉ ุงูุชูููู">
                            <input type="text" class="w-full p-2 border border-gray-300 rounded" placeholder="ุฃุฏุฎู ุงูุดุงูุฏ">
                            <button onclick="addOutcomeField('middle-assessment-container')" class="px-4 py-2 bg-accent text-white rounded hover:bg-teal-600">ุฅุถุงูุฉ</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 space-x-reverse mt-8 no-print">
                <button onclick="saveData('middle')" class="px-6 py-3 bg-accent text-white rounded-lg hover:bg-teal-600 transition-colors">ุญูุธ ุงูุจูุงูุงุช</button>
                <button onclick="printSection('middleSection')" class="px-6 py-3 bg-secondary text-white rounded-lg hover:bg-blue-600 transition-colors">ุทุจุงุนุฉ</button>
                <button onclick="exportToWord('middle')" class="px-6 py-3 bg-primary text-white rounded-lg hover:bg-green-600 transition-colors">ุชุตุฏูุฑ ุฅูู Word</button>
            </div>
        </div>
    </div>

    <!-- Admin Dashboard -->
    <div id="adminSection" class="container mx-auto p-6 hidden">
        <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
            <h2 class="text-2xl font-bold text-gold mb-6 text-center">ููุญุฉ ูุชุงุจุนุฉ ุงููุฏูุฑ</h2>
            
            <!-- Teacher Management Section -->
            <div class="bg-gray-50 p-6 rounded-lg mb-8">
                <h3 class="text-xl font-bold text-dark mb-4">ุฅุฏุงุฑุฉ ุงููุนูููู ูุงููุนููุงุช</h3>
                
                <!-- Import Instructions -->
                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6">
                    <h4 class="text-lg font-semibold text-blue-800 mb-2">๐ ุชุนูููุงุช ุงูุงุณุชูุฑุงุฏ ูู Excel</h4>
                    <div class="text-sm text-blue-700 space-y-1">
                        <p>โข ุงุถุบุท ุนูู "ุชุญููู ูููุฐุฌ Excel" ููุญุตูู ุนูู ุงูููู ุงููููุฐุฌู</p>
                        <p>โข ุงููุฃ ุงูุจูุงูุงุช ูู ุงูุฃุนูุฏุฉ: ุงูุงุณูุ ุงูุชุฎุตุตุ ุงููุฑุญูุฉ</p>
                        <p>โข ุงุญูุธ ุงูููู ุจุตูุบุฉ Excel (.xlsx ุฃู .xls)</p>
                        <p>โข ุงุถุบุท ุนูู "ุงุณุชูุฑุงุฏ ูู Excel" ูุงุฎุชุฑ ุงูููู</p>
                        <p>โข ุณูุชู ุชุฌุงูู ุงููุนูููู ุงูููุฌูุฏูู ูุณุจูุงู ุชููุงุฆูุงู</p>
                    </div>
                </div>
                
                <!-- Add Teacher Form -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                    <div>
                        <label class="block text-dark font-semibold mb-2">ุงุณู ุงููุนูู/ุงููุนููุฉ</label>
                        <input type="text" id="teacher-name" class="w-full p-3 border border-gold rounded-lg focus:outline-none focus:ring-2 focus:ring-gold" placeholder="ุฃุฏุฎู ุงุณู ุงููุนูู/ุงููุนููุฉ">
                    </div>
                    <div>
                        <label class="block text-dark font-semibold mb-2">ุงูุชุฎุตุต</label>
                        <select id="teacher-subject" class="w-full p-3 border border-gold rounded-lg focus:outline-none focus:ring-2 focus:ring-gold">
                            <option value="">ุงุฎุชุฑ ุงูุชุฎุตุต</option>
                            <option value="ุงููุบุฉ ุงูุนุฑุจูุฉ">ุงููุบุฉ ุงูุนุฑุจูุฉ</option>
                            <option value="ุงูุฑูุงุถูุงุช">ุงูุฑูุงุถูุงุช</option>
                            <option value="ุงูุนููู">ุงูุนููู</option>
                            <option value="ุงูุชุฑุจูุฉ ุงูุฅุณูุงููุฉ">ุงูุชุฑุจูุฉ ุงูุฅุณูุงููุฉ</option>
                            <option value="ุงูุชุฑุจูุฉ ุงูุงุฌุชูุงุนูุฉ">ุงูุชุฑุจูุฉ ุงูุงุฌุชูุงุนูุฉ</option>
                            <option value="ุงูุฏุฑุงุณุงุช ุงูุงุฌุชูุงุนูุฉ">ุงูุฏุฑุงุณุงุช ุงูุงุฌุชูุงุนูุฉ</option>
                            <option value="ุงููุบุฉ ุงูุฅูุฌููุฒูุฉ">ุงููุบุฉ ุงูุฅูุฌููุฒูุฉ</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-dark font-semibold mb-2">ุงููุฑุญูุฉ</label>
                        <select id="teacher-stage" class="w-full p-3 border border-gold rounded-lg focus:outline-none focus:ring-2 focus:ring-gold">
                            <option value="">ุงุฎุชุฑ ุงููุฑุญูุฉ</option>
                            <option value="ุงุจุชุฏุงุฆูุฉ">ุงุจุชุฏุงุฆูุฉ</option>
                            <option value="ูุชูุณุทุฉ">ูุชูุณุทุฉ</option>
                            <option value="ุงุจุชุฏุงุฆูุฉ ููุชูุณุทุฉ">ุงุจุชุฏุงุฆูุฉ ููุชูุณุทุฉ</option>
                        </select>
                    </div>
                </div>
                
                <div class="flex justify-center space-x-4 space-x-reverse mb-4">
                    <button onclick="addTeacher()" class="px-6 py-3 bg-gold text-dark rounded-lg hover:bg-yellow-600 hover:text-white transition-colors font-semibold">ุฅุถุงูุฉ ุงููุนูู/ุงููุนููุฉ</button>
                    <div class="relative">
                        <input type="file" id="excel-file" accept=".xlsx,.xls" class="hidden" onchange="importFromExcel(event)">
                        <button onclick="document.getElementById('excel-file').click()" class="px-6 py-3 bg-secondary text-white rounded-lg hover:bg-blue-600 transition-colors font-semibold">ุงุณุชูุฑุงุฏ ูู Excel</button>
                    </div>
                    <button onclick="downloadTemplate()" class="px-6 py-3 bg-accent text-white rounded-lg hover:bg-teal-600 transition-colors font-semibold">ุชุญููู ูููุฐุฌ Excel</button>
                </div>

                <!-- Teachers List -->
                <div class="overflow-x-auto">
                    <table class="w-full border-collapse border border-gray-300">
                        <thead>
                            <tr class="bg-dark text-white">
                                <th class="border border-gray-300 p-3">ุงูุงุณู</th>
                                <th class="border border-gray-300 p-3">ุงูุชุฎุตุต</th>
                                <th class="border border-gray-300 p-3">ุงููุฑุญูุฉ</th>
                                <th class="border border-gray-300 p-3">ุชุงุฑูุฎ ุงูุฅุถุงูุฉ</th>
                                <th class="border border-gray-300 p-3">ุงููุตุฏุฑ</th>
                                <th class="border border-gray-300 p-3">ุงูุฅุฌุฑุงุกุงุช</th>
                            </tr>
                        </thead>
                        <tbody id="teachersTable">
                            <tr>
                                <td colspan="6" class="border border-gray-300 p-4 text-center text-gray-500">ูุง ููุฌุฏ ูุนูููู ูุถุงููู</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Progress Overview -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                <div class="bg-gradient-to-r from-primary to-secondary p-6 rounded-lg text-white">
                    <h3 class="text-xl font-bold mb-4">ุงููุฑุญูุฉ ุงูุงุจุชุฏุงุฆูุฉ</h3>
                    <div class="space-y-2">
                        <div class="flex justify-between">
                            <span>ุงูุฎุฑุงุฆุท ุงูููุชููุฉ:</span>
                            <span id="elementary-completed">0</span>
                        </div>
                        <div class="flex justify-between">
                            <span>ุงูุฎุฑุงุฆุท ููุฏ ุงูุฅูุฌุงุฒ:</span>
                            <span id="elementary-progress">0</span>
                        </div>
                        <div class="w-full bg-white bg-opacity-30 rounded-full h-2">
                            <div id="elementary-progress-bar" class="bg-white h-2 rounded-full" style="width: 0%"></div>
                        </div>
                    </div>
                </div>
                
                <div class="bg-gradient-to-r from-accent to-secondary p-6 rounded-lg text-white">
                    <h3 class="text-xl font-bold mb-4">ุงููุฑุญูุฉ ุงููุชูุณุทุฉ</h3>
                    <div class="space-y-2">
                        <div class="flex justify-between">
                            <span>ุงูุฎุฑุงุฆุท ุงูููุชููุฉ:</span>
                            <span id="middle-completed">0</span>
                        </div>
                        <div class="flex justify-between">
                            <span>ุงูุฎุฑุงุฆุท ููุฏ ุงูุฅูุฌุงุฒ:</span>
                            <span id="middle-progress">0</span>
                        </div>
                        <div class="w-full bg-white bg-opacity-30 rounded-full h-2">
                            <div id="middle-progress-bar" class="bg-white h-2 rounded-full" style="width: 0%"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Charts -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                <div class="bg-gray-50 p-4 rounded-lg">
                    <h3 class="text-lg font-bold text-dark mb-4 text-center">ูุณุจุฉ ุงูุฅูุฌุงุฒ ุญุณุจ ุงููุฑุญูุฉ</h3>
                    <canvas id="stageChart" width="400" height="200"></canvas>
                </div>
                
                <div class="bg-gray-50 p-4 rounded-lg">
                    <h3 class="text-lg font-bold text-dark mb-4 text-center">ูุณุจุฉ ุงูุฅูุฌุงุฒ ุญุณุจ ุงููุงุฏุฉ</h3>
                    <canvas id="subjectChart" width="400" height="200"></canvas>
                </div>
            </div>

            <!-- Detailed Reports -->
            <div class="bg-gray-50 p-6 rounded-lg">
                <h3 class="text-xl font-bold text-dark mb-4">ุชูุงุฑูุฑ ููุตูุฉ</h3>
                <div class="overflow-x-auto">
                    <table class="w-full border-collapse border border-gray-300">
                        <thead>
                            <tr class="bg-dark text-white">
                                <th class="border border-gray-300 p-3">ุงููุฑุญูุฉ</th>
                                <th class="border border-gray-300 p-3">ุงููุงุฏุฉ</th>
                                <th class="border border-gray-300 p-3">ุงูุตู</th>
                                <th class="border border-gray-300 p-3">ุงููุนูู/ุงููุนููุฉ</th>
                                <th class="border border-gray-300 p-3">ุชุงุฑูุฎ ุงูุฅูุดุงุก</th>
                                <th class="border border-gray-300 p-3">ุขุฎุฑ ุชุญุฏูุซ</th>
                                <th class="border border-gray-300 p-3">ูุณุจุฉ ุงูุฅูุฌุงุฒ</th>
                                <th class="border border-gray-300 p-3">ุงูุญุงูุฉ</th>
                            </tr>
                        </thead>
                        <tbody id="reportsTable">
                            <tr>
                                <td colspan="8" class="border border-gray-300 p-4 text-center text-gray-500">ูุง ุชูุฌุฏ ุจูุงูุงุช ูุชุงุญุฉ</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Export Options -->
            <div class="flex justify-center space-x-4 space-x-reverse mt-8 no-print">
                <button onclick="exportAllReports()" class="px-6 py-3 bg-gold text-dark rounded-lg hover:bg-yellow-600 hover:text-white transition-colors">ุชุตุฏูุฑ ุฌููุน ุงูุชูุงุฑูุฑ</button>
                <button onclick="printSection('adminSection')" class="px-6 py-3 bg-secondary text-white rounded-lg hover:bg-blue-600 transition-colors">ุทุจุงุนุฉ ุงูุชูุฑูุฑ</button>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-dark text-white p-4 mt-8">
        <div class="container mx-auto text-center">
            <p class="text-lg">ูุฏูุฑ ุงููุฏุฑุณุฉ: ุนุจุฏุงูุฑุญูู ุงูุณููู</p>
            <p class="text-sm mt-2">ูุฏุฑุณุฉ ุงุจุชุฏุงุฆูุฉ ููุชูุณุทุฉ ุงูุตูุงุฑูุฉ - ุฌุงุฒุงู</p>
        </div>
    </footer>

    <script>
        // Global variables
        let elementaryData = JSON.parse(localStorage.getItem('elementaryData')) || [];
        let middleData = JSON.parse(localStorage.getItem('middleData')) || [];
        let teachersData = JSON.parse(localStorage.getItem('teachersData')) || [];
        
        // Initialize charts
        let stageChart, subjectChart;

        // Update date and time
        function updateDateTime() {
            const now = new Date();
            const dateOptions = { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric',
                calendar: 'islamic-umalqura'
            };
            const timeOptions = { 
                hour: '2-digit', 
                minute: '2-digit', 
                second: '2-digit',
                hour12: true
            };
            
            document.getElementById('current-date').textContent = now.toLocaleDateString('ar-SA', dateOptions);
            document.getElementById('current-time').textContent = now.toLocaleTimeString('ar-SA', timeOptions);
        }

        // Set current date in date inputs
        function setCurrentDate() {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('elementary-creation-date').value = today;
            document.getElementById('middle-creation-date').value = today;
        }

        // Show/Hide sections
        function showSection(section) {
            // Hide all sections
            document.getElementById('elementarySection').classList.add('hidden');
            document.getElementById('middleSection').classList.add('hidden');
            document.getElementById('adminSection').classList.add('hidden');
            
            // Remove active class from all buttons
            document.getElementById('elementaryBtn').classList.remove('bg-primary');
            document.getElementById('middleBtn').classList.remove('bg-primary');
            document.getElementById('adminBtn').classList.remove('bg-primary');
            
            // Show selected section and activate button
            if (section === 'elementary') {
                document.getElementById('elementarySection').classList.remove('hidden');
                document.getElementById('elementaryBtn').classList.add('bg-primary');
            } else if (section === 'middle') {
                document.getElementById('middleSection').classList.remove('hidden');
                document.getElementById('middleBtn').classList.add('bg-primary');
            } else if (section === 'admin') {
                document.getElementById('adminSection').classList.remove('hidden');
                document.getElementById('adminBtn').classList.add('bg-primary');
                updateAdminDashboard();
            }
        }

        // Excel Import Functions
        function importFromExcel(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, { type: 'array' });
                    const sheetName = workbook.SheetNames[0];
                    const worksheet = workbook.Sheets[sheetName];
                    const jsonData = XLSX.utils.sheet_to_json(worksheet);
                    
                    processExcelData(jsonData);
                } catch (error) {
                    alert('ุฎุทุฃ ูู ูุฑุงุกุฉ ุงูููู. ุชุฃูุฏ ูู ุฃู ุงูููู ุจุตูุบุฉ Excel ุตุญูุญุฉ.');
                    console.error('Excel import error:', error);
                }
            };
            reader.readAsArrayBuffer(file);
            
            // Reset file input
            event.target.value = '';
        }
        
        function processExcelData(data) {
            if (!data || data.length === 0) {
                alert('ุงูููู ูุงุฑุบ ุฃู ูุง ูุญุชูู ุนูู ุจูุงูุงุช ุตุญูุญุฉ');
                return;
            }
            
            let importedCount = 0;
            let skippedCount = 0;
            let errors = [];
            
            data.forEach((row, index) => {
                try {
                    // Check for required columns (flexible column names)
                    const name = row['ุงูุงุณู'] || row['ุงุณู ุงููุนูู'] || row['ุงููุนูู'] || row['Name'] || '';
                    const subject = row['ุงูุชุฎุตุต'] || row['ุงููุงุฏุฉ'] || row['Subject'] || '';
                    const stage = row['ุงููุฑุญูุฉ'] || row['Stage'] || '';
                    
                    if (!name.trim()) {
                        errors.push(`ุงูุตู ${index + 2}: ุงุณู ุงููุนูู ูุทููุจ`);
                        return;
                    }
                    
                    if (!subject.trim()) {
                        errors.push(`ุงูุตู ${index + 2}: ุงูุชุฎุตุต ูุทููุจ`);
                        return;
                    }
                    
                    if (!stage.trim()) {
                        errors.push(`ุงูุตู ${index + 2}: ุงููุฑุญูุฉ ูุทููุจุฉ`);
                        return;
                    }
                    
                    // Validate stage values
                    const validStages = ['ุงุจุชุฏุงุฆูุฉ', 'ูุชูุณุทุฉ', 'ุงุจุชุฏุงุฆูุฉ ููุชูุณุทุฉ'];
                    if (!validStages.includes(stage.trim())) {
                        errors.push(`ุงูุตู ${index + 2}: ุงููุฑุญูุฉ ูุฌุจ ุฃู ุชููู ุฅุญุฏู ุงูููู: ${validStages.join(', ')}`);
                        return;
                    }
                    
                    // Check if teacher already exists
                    if (teachersData.some(teacher => teacher.name.toLowerCase() === name.trim().toLowerCase())) {
                        skippedCount++;
                        return;
                    }
                    
                    // Add teacher
                    const teacher = {
                        id: Date.now() + Math.random(),
                        name: name.trim(),
                        subject: subject.trim(),
                        stage: stage.trim(),
                        dateAdded: new Date().toISOString(),
                        importedFromExcel: true
                    };
                    
                    teachersData.push(teacher);
                    importedCount++;
                    
                } catch (error) {
                    errors.push(`ุงูุตู ${index + 2}: ุฎุทุฃ ูู ูุนุงูุฌุฉ ุงูุจูุงูุงุช`);
                }
            });
            
            // Save to localStorage
            localStorage.setItem('teachersData', JSON.stringify(teachersData));
            
            // Update UI
            updateTeachersTable();
            updateTeacherDropdowns();
            
            // Show results
            let message = `ุชู ุงุณุชูุฑุงุฏ ${importedCount} ูุนูู/ูุนููุฉ ุจูุฌุงุญ`;
            if (skippedCount > 0) {
                message += `\nุชู ุชุฎุทู ${skippedCount} ูุนูู/ูุนููุฉ (ููุฌูุฏ ูุณุจูุงู)`;
            }
            if (errors.length > 0) {
                message += `\n\nุฃุฎุทุงุก:\n${errors.slice(0, 5).join('\n')}`;
                if (errors.length > 5) {
                    message += `\n... ู ${errors.length - 5} ุฃุฎุทุงุก ุฃุฎุฑู`;
                }
            }
            
            alert(message);
        }
        
        function downloadTemplate() {
            // Create template data
            const templateData = [
                {
                    'ุงูุงุณู': 'ุฃุญูุฏ ูุญูุฏ ุงูุณุนูุฏ',
                    'ุงูุชุฎุตุต': 'ุงููุบุฉ ุงูุนุฑุจูุฉ',
                    'ุงููุฑุญูุฉ': 'ุงุจุชุฏุงุฆูุฉ'
                },
                {
                    'ุงูุงุณู': 'ูุงุทูุฉ ุนูู ุฃุญูุฏ',
                    'ุงูุชุฎุตุต': 'ุงูุฑูุงุถูุงุช',
                    'ุงููุฑุญูุฉ': 'ูุชูุณุทุฉ'
                },
                {
                    'ุงูุงุณู': 'ูุญูุฏ ุนุจุฏุงููู ุญุณู',
                    'ุงูุชุฎุตุต': 'ุงูุนููู',
                    'ุงููุฑุญูุฉ': 'ุงุจุชุฏุงุฆูุฉ ููุชูุณุทุฉ'
                }
            ];
            
            // Create workbook
            const wb = XLSX.utils.book_new();
            const ws = XLSX.utils.json_to_sheet(templateData);
            
            // Set column widths
            ws['!cols'] = [
                { width: 25 }, // ุงูุงุณู
                { width: 20 }, // ุงูุชุฎุตุต
                { width: 20 }  // ุงููุฑุญูุฉ
            ];
            
            // Add instructions sheet
            const instructions = [
                { 'ุงูุชุนูููุงุช': 'ูุฑุฌู ููุก ุงูุจูุงูุงุช ูู ุงูุฃุนูุฏุฉ ุงูุชุงููุฉ:' },
                { 'ุงูุชุนูููุงุช': '1. ุงูุงุณู: ุงุณู ุงููุนูู/ุงููุนููุฉ ูุงููุงู' },
                { 'ุงูุชุนูููุงุช': '2. ุงูุชุฎุตุต: ุงููุงุฏุฉ ุงูุชู ูุฏุฑุณูุง' },
                { 'ุงูุชุนูููุงุช': '3. ุงููุฑุญูุฉ: ุงุจุชุฏุงุฆูุฉ ุฃู ูุชูุณุทุฉ ุฃู ุงุจุชุฏุงุฆูุฉ ููุชูุณุทุฉ' },
                { 'ุงูุชุนูููุงุช': '' },
                { 'ุงูุชุนูููุงุช': 'ุงูุชุฎุตุตุงุช ุงููุชุงุญุฉ:' },
                { 'ุงูุชุนูููุงุช': '- ุงููุบุฉ ุงูุนุฑุจูุฉ' },
                { 'ุงูุชุนูููุงุช': '- ุงูุฑูุงุถูุงุช' },
                { 'ุงูุชุนูููุงุช': '- ุงูุนููู' },
                { 'ุงูุชุนูููุงุช': '- ุงูุชุฑุจูุฉ ุงูุฅุณูุงููุฉ' },
                { 'ุงูุชุนูููุงุช': '- ุงูุชุฑุจูุฉ ุงูุงุฌุชูุงุนูุฉ' },
                { 'ุงูุชุนูููุงุช': '- ุงูุฏุฑุงุณุงุช ุงูุงุฌุชูุงุนูุฉ' },
                { 'ุงูุชุนูููุงุช': '- ุงููุบุฉ ุงูุฅูุฌููุฒูุฉ' },
                { 'ุงูุชุนูููุงุช': '' },
                { 'ุงูุชุนูููุงุช': 'ุงููุฑุงุญู ุงููุชุงุญุฉ:' },
                { 'ุงูุชุนูููุงุช': '- ุงุจุชุฏุงุฆูุฉ' },
                { 'ุงูุชุนูููุงุช': '- ูุชูุณุทุฉ' },
                { 'ุงูุชุนูููุงุช': '- ุงุจุชุฏุงุฆูุฉ ููุชูุณุทุฉ' }
            ];
            
            const wsInstructions = XLSX.utils.json_to_sheet(instructions);
            wsInstructions['!cols'] = [{ width: 50 }];
            
            // Add sheets to workbook
            XLSX.utils.book_append_sheet(wb, wsInstructions, 'ุงูุชุนูููุงุช');
            XLSX.utils.book_append_sheet(wb, ws, 'ุจูุงูุงุช ุงููุนูููู');
            
            // Download file
            XLSX.writeFile(wb, 'ูููุฐุฌ_ุจูุงูุงุช_ุงููุนูููู.xlsx');
        }

        // Teacher Management Functions
        function addTeacher() {
            const name = document.getElementById('teacher-name').value.trim();
            const subject = document.getElementById('teacher-subject').value;
            const stage = document.getElementById('teacher-stage').value;
            
            if (!name || !subject || !stage) {
                alert('ูุฑุฌู ุฅููุงู ุฌููุน ุงูุจูุงูุงุช');
                return;
            }
            
            // Check if teacher already exists
            if (teachersData.some(teacher => teacher.name === name)) {
                alert('ูุฐุง ุงููุนูู/ุงููุนููุฉ ููุฌูุฏ ุจุงููุนู');
                return;
            }
            
            const teacher = {
                id: Date.now(),
                name: name,
                subject: subject,
                stage: stage,
                dateAdded: new Date().toISOString()
            };
            
            teachersData.push(teacher);
            localStorage.setItem('teachersData', JSON.stringify(teachersData));
            
            // Clear form
            document.getElementById('teacher-name').value = '';
            document.getElementById('teacher-subject').value = '';
            document.getElementById('teacher-stage').value = '';
            
            updateTeachersTable();
            updateTeacherDropdowns();
            alert('ุชู ุฅุถุงูุฉ ุงููุนูู/ุงููุนููุฉ ุจูุฌุงุญ');
        }

        function deleteTeacher(id) {
            if (confirm('ูู ุฃูุช ูุชุฃูุฏ ูู ุญุฐู ูุฐุง ุงููุนูู/ุงููุนููุฉุ')) {
                teachersData = teachersData.filter(teacher => teacher.id !== id);
                localStorage.setItem('teachersData', JSON.stringify(teachersData));
                updateTeachersTable();
                updateTeacherDropdowns();
            }
        }

        function updateTeachersTable() {
            const tbody = document.getElementById('teachersTable');
            
            if (teachersData.length === 0) {
                tbody.innerHTML = '<tr><td colspan="5" class="border border-gray-300 p-4 text-center text-gray-500">ูุง ููุฌุฏ ูุนูููู ูุถุงููู</td></tr>';
                return;
            }
            
            tbody.innerHTML = teachersData.map(teacher => `
                <tr>
                    <td class="border border-gray-300 p-3">${teacher.name}</td>
                    <td class="border border-gray-300 p-3">${teacher.subject}</td>
                    <td class="border border-gray-300 p-3">${teacher.stage}</td>
                    <td class="border border-gray-300 p-3">${new Date(teacher.dateAdded).toLocaleDateString('ar-SA')}</td>
                    <td class="border border-gray-300 p-3">
                        <span class="px-2 py-1 rounded text-xs ${teacher.importedFromExcel ? 'bg-blue-100 text-blue-800' : 'bg-green-100 text-green-800'}">
                            ${teacher.importedFromExcel ? 'Excel' : 'ูุฏูู'}
                        </span>
                    </td>
                    <td class="border border-gray-300 p-3">
                        <button onclick="deleteTeacher(${teacher.id})" class="px-3 py-1 bg-red-500 text-white rounded text-sm hover:bg-red-600">ุญุฐู</button>
                    </td>
                </tr>
            `).join('');
        }

        function updateTeacherDropdowns() {
            const elementarySelect = document.getElementById('elementary-teacher');
            const middleSelect = document.getElementById('middle-teacher');
            
            // Clear existing options except first
            elementarySelect.innerHTML = '<option value="">ุงุฎุชุฑ ุงููุนูู/ุงููุนููุฉ</option>';
            middleSelect.innerHTML = '<option value="">ุงุฎุชุฑ ุงููุนูู/ุงููุนููุฉ</option>';
            
            // Add teachers to appropriate dropdowns
            teachersData.forEach(teacher => {
                if (teacher.stage === 'ุงุจุชุฏุงุฆูุฉ' || teacher.stage === 'ุงุจุชุฏุงุฆูุฉ ููุชูุณุทุฉ') {
                    elementarySelect.innerHTML += `<option value="${teacher.name}">${teacher.name} - ${teacher.subject}</option>`;
                }
                if (teacher.stage === 'ูุชูุณุทุฉ' || teacher.stage === 'ุงุจุชุฏุงุฆูุฉ ููุชูุณุทุฉ') {
                    middleSelect.innerHTML += `<option value="${teacher.name}">${teacher.name} - ${teacher.subject}</option>`;
                }
            });
        }

        // Add field functionality
        function addField(containerId) {
            const container = document.getElementById(containerId);
            const inputs = container.querySelectorAll('input');
            
            if (inputs.length >= 10) {
                alert('ูููู ุฅุถุงูุฉ 10 ุนูุงุตุฑ ูุญุฏ ุฃูุตู');
                return;
            }
            
            const newField = document.createElement('div');
            newField.className = 'flex gap-2 mb-2';
            newField.innerHTML = `
                <input type="text" class="flex-1 p-2 border border-gray-300 rounded" placeholder="ุฃุฏุฎู ุงูุจูุงูุงุช">
                <button onclick="removeField(this)" class="px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600">ุญุฐู</button>
            `;
            
            container.appendChild(newField);
        }

        // Add outcome field with evidence
        function addOutcomeField(containerId) {
            const container = document.getElementById(containerId);
            const fieldGroups = container.querySelectorAll('.space-y-2');
            
            if (fieldGroups.length >= 10) {
                alert('ูููู ุฅุถุงูุฉ 10 ุนูุงุตุฑ ูุญุฏ ุฃูุตู');
                return;
            }
            
            const newField = document.createElement('div');
            newField.className = 'space-y-2 mb-2 p-3 border border-gray-200 rounded';
            newField.innerHTML = `
                <input type="text" class="w-full p-2 border border-gray-300 rounded" placeholder="ุฃุฏุฎู ุงูุจูุงูุงุช">
                <input type="text" class="w-full p-2 border border-gray-300 rounded" placeholder="ุฃุฏุฎู ุงูุดุงูุฏ">
                <button onclick="removeField(this.parentElement)" class="px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600">ุญุฐู</button>
            `;
            
            container.appendChild(newField);
        }

        // Remove field
        function removeField(element) {
            element.remove();
        }

        // Save data
        function saveData(stage) {
            const data = {
                id: Date.now(),
                timestamp: new Date().toISOString(),
                subject: document.getElementById(`${stage}-subject`).value,
                grade: document.getElementById(`${stage}-grade`).value,
                semester: document.getElementById(`${stage}-semester`).value,
                teacher: document.getElementById(`${stage}-teacher`).value,
                creationDate: document.getElementById(`${stage}-creation-date`).value,
                updateDate: new Date().toISOString().split('T')[0],
                units: getFieldValues(`${stage}-units-container`),
                objectives: getFieldValues(`${stage}-objectives-container`),
                content: getFieldValues(`${stage}-content-container`),
                outcomes: getOutcomeValues(`${stage}-outcomes-container`),
                activities: getOutcomeValues(`${stage}-activities-container`),
                methods: getOutcomeValues(`${stage}-methods-container`),
                assessment: getOutcomeValues(`${stage}-assessment-container`)
            };

            // Update the update date field
            document.getElementById(`${stage}-update-date`).value = data.updateDate;

            if (stage === 'elementary') {
                elementaryData.push(data);
                localStorage.setItem('elementaryData', JSON.stringify(elementaryData));
            } else {
                middleData.push(data);
                localStorage.setItem('middleData', JSON.stringify(middleData));
            }

            alert('ุชู ุญูุธ ุงูุจูุงูุงุช ุจูุฌุงุญ!');
            clearForm(stage);
        }

        // Get field values
        function getFieldValues(containerId) {
            const container = document.getElementById(containerId);
            const inputs = container.querySelectorAll('input[type="text"]');
            return Array.from(inputs).map(input => input.value).filter(value => value.trim() !== '');
        }

        // Get outcome values with evidence
        function getOutcomeValues(containerId) {
            const container = document.getElementById(containerId);
            const fieldGroups = container.querySelectorAll('.space-y-2');
            const results = [];
            
            fieldGroups.forEach(group => {
                const inputs = group.querySelectorAll('input[type="text"]');
                if (inputs.length >= 2 && inputs[0].value.trim() !== '') {
                    results.push({
                        content: inputs[0].value,
                        evidence: inputs[1].value
                    });
                }
            });
            
            return results;
        }

        // Clear form
        function clearForm(stage) {
            document.getElementById(`${stage}-subject`).value = '';
            document.getElementById(`${stage}-grade`).value = '';
            document.getElementById(`${stage}-semester`).value = '';
            document.getElementById(`${stage}-teacher`).value = '';
            
            // Reset dates
            setCurrentDate();
            document.getElementById(`${stage}-update-date`).value = '';
            
            // Clear all dynamic fields
            const containers = [
                `${stage}-units-container`,
                `${stage}-objectives-container`,
                `${stage}-content-container`,
                `${stage}-outcomes-container`,
                `${stage}-activities-container`,
                `${stage}-methods-container`,
                `${stage}-assessment-container`
            ];
            
            containers.forEach(containerId => {
                const container = document.getElementById(containerId);
                const dynamicFields = container.querySelectorAll('.flex, .space-y-2');
                dynamicFields.forEach((field, index) => {
                    if (index > 0) field.remove();
                });
                
                // Clear first field
                const inputs = container.querySelectorAll('input[type="text"]');
                inputs.forEach(input => input.value = '');
            });
        }

        // Print section
        function printSection(sectionId) {
            const section = document.getElementById(sectionId);
            const printWindow = window.open('', '_blank');
            printWindow.document.write(`
                <html>
                <head>
                    <title>ุทุจุงุนุฉ</title>
                    <style>
                        body { font-family: 'Tajawal', Arial, sans-serif; direction: rtl; }
                        .no-print { display: none !important; }
                        @media print { body { background: white !important; } }
                    </style>
                </head>
                <body>
                    ${section.innerHTML}
                </body>
                </html>
            `);
            printWindow.document.close();
            printWindow.print();
        }

        // Export to Word
        function exportToWord(stage) {
            const data = stage === 'elementary' ? elementaryData : middleData;
            if (data.length === 0) {
                alert('ูุง ุชูุฌุฏ ุจูุงูุงุช ููุชุตุฏูุฑ');
                return;
            }
            
            let content = `
                <html>
                <head>
                    <meta charset="UTF-8">
                    <style>
                        body { font-family: Arial, sans-serif; direction: rtl; }
                        table { border-collapse: collapse; width: 100%; }
                        th, td { border: 1px solid black; padding: 8px; text-align: right; }
                        th { background-color: #f2f2f2; }
                    </style>
                </head>
                <body>
                    <h1>ุชูุฑูุฑ ุฎุฑูุทุฉ ููุงุชุฌ ุงูุชุนูู - ${stage === 'elementary' ? 'ุงููุฑุญูุฉ ุงูุงุจุชุฏุงุฆูุฉ' : 'ุงููุฑุญูุฉ ุงููุชูุณุทุฉ'}</h1>
                    <p>ูุฏุฑุณุฉ ุงุจุชุฏุงุฆูุฉ ููุชูุณุทุฉ ุงูุตูุงุฑูุฉ - ุฌุงุฒุงู</p>
                    <p>ูุฏูุฑ ุงููุฏุฑุณุฉ: ุนุจุฏุงูุฑุญูู ุงูุณููู</p>
                    <p>ุชุงุฑูุฎ ุงูุชูุฑูุฑ: ${new Date().toLocaleDateString('ar-SA')}</p>
            `;
            
            data.forEach((item, index) => {
                content += `
                    <h2>ุฎุฑูุทุฉ ุฑูู ${index + 1}</h2>
                    <table>
                        <tr><th>ุงููุงุฏุฉ</th><td>${item.subject}</td></tr>
                        <tr><th>ุงูุตู</th><td>${item.grade}</td></tr>
                        <tr><th>ุงููุตู ุงูุฏุฑุงุณู</th><td>${item.semester}</td></tr>
                        <tr><th>ุงููุนูู/ุงููุนููุฉ</th><td>${item.teacher}</td></tr>
                        <tr><th>ุชุงุฑูุฎ ุงูุฅูุดุงุก</th><td>${item.creationDate}</td></tr>
                        <tr><th>ุขุฎุฑ ุชุญุฏูุซ</th><td>${item.updateDate}</td></tr>
                        <tr><th>ุงููุญุฏุงุช</th><td>${item.units.join(', ')}</td></tr>
                        <tr><th>ุงูุฃูุฏุงู ุงูุชุนููููุฉ</th><td>${item.objectives.join(', ')}</td></tr>
                        <tr><th>ุงููุญุชูู</th><td>${item.content.join(', ')}</td></tr>
                    </table>
                    <br>
                `;
            });
            
            content += '</body></html>';
            
            const blob = new Blob([content], { type: 'application/msword' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `ุฎุฑูุทุฉ_ููุงุชุฌ_ุงูุชุนูู_${stage}.doc`;
            a.click();
            URL.revokeObjectURL(url);
        }

        // Update admin dashboard
        function updateAdminDashboard() {
            updateTeachersTable();
            
            // Calculate completion rates
            const elementaryCompleted = calculateCompletionRate(elementaryData);
            const middleCompleted = calculateCompletionRate(middleData);
            
            // Update progress displays
            document.getElementById('elementary-completed').textContent = elementaryCompleted.completed;
            document.getElementById('elementary-progress').textContent = elementaryCompleted.total - elementaryCompleted.completed;
            document.getElementById('elementary-progress-bar').style.width = `${elementaryCompleted.percentage}%`;
            
            document.getElementById('middle-completed').textContent = middleCompleted.completed;
            document.getElementById('middle-progress').textContent = middleCompleted.total - middleCompleted.completed;
            document.getElementById('middle-progress-bar').style.width = `${middleCompleted.percentage}%`;
            
            // Update charts
            updateCharts();
            
            // Update reports table
            updateReportsTable();
        }

        // Calculate completion rate
        function calculateCompletionRate(data) {
            const total = data.length;
            const completed = data.filter(item => {
                return item.units.length > 0 && 
                       item.objectives.length > 0 && 
                       item.content.length > 0 && 
                       item.outcomes.length > 0 && 
                       item.activities.length > 0 && 
                       item.methods.length > 0 && 
                       item.assessment.length > 0;
            }).length;
            
            return {
                total,
                completed,
                percentage: total > 0 ? Math.round((completed / total) * 100) : 0
            };
        }

        // Update charts
        function updateCharts() {
            const ctx1 = document.getElementById('stageChart').getContext('2d');
            const ctx2 = document.getElementById('subjectChart').getContext('2d');
            
            // Destroy existing charts
            if (stageChart) stageChart.destroy();
            if (subjectChart) subjectChart.destroy();
            
            // Stage completion chart
            const elementaryRate = calculateCompletionRate(elementaryData);
            const middleRate = calculateCompletionRate(middleData);
            
            stageChart = new Chart(ctx1, {
                type: 'doughnut',
                data: {
                    labels: ['ุงููุฑุญูุฉ ุงูุงุจุชุฏุงุฆูุฉ', 'ุงููุฑุญูุฉ ุงููุชูุณุทุฉ'],
                    datasets: [{
                        data: [elementaryRate.percentage, middleRate.percentage],
                        backgroundColor: ['#07A869', '#0DA9A6']
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
            
            // Subject completion chart
            const subjectData = getSubjectCompletionData();
            
            subjectChart = new Chart(ctx2, {
                type: 'bar',
                data: {
                    labels: Object.keys(subjectData),
                    datasets: [{
                        label: 'ูุณุจุฉ ุงูุฅูุฌุงุฒ %',
                        data: Object.values(subjectData),
                        backgroundColor: '#3D7EB9'
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100
                        }
                    }
                }
            });
        }

        // Get subject completion data
        function getSubjectCompletionData() {
            const allData = [...elementaryData, ...middleData];
            const subjects = {};
            
            allData.forEach(item => {
                if (!subjects[item.subject]) {
                    subjects[item.subject] = { total: 0, completed: 0 };
                }
                subjects[item.subject].total++;
                
                if (item.units.length > 0 && item.objectives.length > 0 && 
                    item.content.length > 0 && item.outcomes.length > 0) {
                    subjects[item.subject].completed++;
                }
            });
            
            const result = {};
            Object.keys(subjects).forEach(subject => {
                const data = subjects[subject];
                result[subject] = data.total > 0 ? Math.round((data.completed / data.total) * 100) : 0;
            });
            
            return result;
        }

        // Update reports table
        function updateReportsTable() {
            const tbody = document.getElementById('reportsTable');
            const allData = [
                ...elementaryData.map(item => ({ ...item, stage: 'ุงูุงุจุชุฏุงุฆูุฉ' })),
                ...middleData.map(item => ({ ...item, stage: 'ุงููุชูุณุทุฉ' }))
            ];
            
            if (allData.length === 0) {
                tbody.innerHTML = '<tr><td colspan="8" class="border border-gray-300 p-4 text-center text-gray-500">ูุง ุชูุฌุฏ ุจูุงูุงุช ูุชุงุญุฉ</td></tr>';
                return;
            }
            
            tbody.innerHTML = allData.map(item => {
                const completionRate = calculateItemCompletion(item);
                const status = completionRate === 100 ? 'ููุชููุฉ' : 'ููุฏ ุงูุฅูุฌุงุฒ';
                const statusClass = completionRate === 100 ? 'text-green-600' : 'text-yellow-600';
                
                return `
                    <tr>
                        <td class="border border-gray-300 p-3">${item.stage}</td>
                        <td class="border border-gray-300 p-3">${item.subject}</td>
                        <td class="border border-gray-300 p-3">${item.grade}</td>
                        <td class="border border-gray-300 p-3">${item.teacher}</td>
                        <td class="border border-gray-300 p-3">${item.creationDate || 'ุบูุฑ ูุญุฏุฏ'}</td>
                        <td class="border border-gray-300 p-3">${item.updateDate || 'ุบูุฑ ูุญุฏุฏ'}</td>
                        <td class="border border-gray-300 p-3">${completionRate}%</td>
                        <td class="border border-gray-300 p-3 ${statusClass}">${status}</td>
                    </tr>
                `;
            }).join('');
        }

        // Calculate item completion
        function calculateItemCompletion(item) {
            const fields = ['units', 'objectives', 'content', 'outcomes', 'activities', 'methods', 'assessment'];
            const completedFields = fields.filter(field => item[field] && item[field].length > 0).length;
            return Math.round((completedFields / fields.length) * 100);
        }

        // Export all reports
        function exportAllReports() {
            const allData = [
                ...elementaryData.map(item => ({ ...item, stage: 'ุงูุงุจุชุฏุงุฆูุฉ' })),
                ...middleData.map(item => ({ ...item, stage: 'ุงููุชูุณุทุฉ' }))
            ];
            
            if (allData.length === 0) {
                alert('ูุง ุชูุฌุฏ ุจูุงูุงุช ููุชุตุฏูุฑ');
                return;
            }
            
            let content = `
                <html>
                <head>
                    <meta charset="UTF-8">
                    <style>
                        body { font-family: Arial, sans-serif; direction: rtl; }
                        table { border-collapse: collapse; width: 100%; margin-bottom: 20px; }
                        th, td { border: 1px solid black; padding: 8px; text-align: right; }
                        th { background-color: #f2f2f2; }
                        h1, h2 { color: #15445A; }
                    </style>
                </head>
                <body>
                    <h1>ุชูุฑูุฑ ุดุงูู ูุฎุฑุงุฆุท ููุงุชุฌ ุงูุชุนูู</h1>
                    <p>ูุฏุฑุณุฉ ุงุจุชุฏุงุฆูุฉ ููุชูุณุทุฉ ุงูุตูุงุฑูุฉ - ุฌุงุฒุงู</p>
                    <p>ูุฏูุฑ ุงููุฏุฑุณุฉ: ุนุจุฏุงูุฑุญูู ุงูุณููู</p>
                    <p>ุชุงุฑูุฎ ุงูุชูุฑูุฑ: ${new Date().toLocaleDateString('ar-SA')}</p>
                    
                    <h2>ููุฎุต ุงูุฅูุฌุงุฒ</h2>
                    <table>
                        <tr><th>ุงููุฑุญูุฉ</th><th>ุนุฏุฏ ุงูุฎุฑุงุฆุท</th><th>ุงูููุชููุฉ</th><th>ููุฏ ุงูุฅูุฌุงุฒ</th><th>ูุณุจุฉ ุงูุฅูุฌุงุฒ</th></tr>
            `;
            
            const elementaryStats = calculateCompletionRate(elementaryData);
            const middleStats = calculateCompletionRate(middleData);
            
            content += `
                        <tr>
                            <td>ุงูุงุจุชุฏุงุฆูุฉ</td>
                            <td>${elementaryStats.total}</td>
                            <td>${elementaryStats.completed}</td>
                            <td>${elementaryStats.total - elementaryStats.completed}</td>
                            <td>${elementaryStats.percentage}%</td>
                        </tr>
                        <tr>
                            <td>ุงููุชูุณุทุฉ</td>
                            <td>${middleStats.total}</td>
                            <td>${middleStats.completed}</td>
                            <td>${middleStats.total - middleStats.completed}</td>
                            <td>${middleStats.percentage}%</td>
                        </tr>
                    </table>
                    
                    <h2>ุชูุงุตูู ุงูุฎุฑุงุฆุท</h2>
                    <table>
                        <tr>
                            <th>ุงููุฑุญูุฉ</th><th>ุงููุงุฏุฉ</th><th>ุงูุตู</th><th>ุงููุนูู/ุงููุนููุฉ</th>
                            <th>ุชุงุฑูุฎ ุงูุฅูุดุงุก</th><th>ุขุฎุฑ ุชุญุฏูุซ</th><th>ูุณุจุฉ ุงูุฅูุฌุงุฒ</th><th>ุงูุญุงูุฉ</th>
                        </tr>
            `;
            
            allData.forEach(item => {
                const completionRate = calculateItemCompletion(item);
                const status = completionRate === 100 ? 'ููุชููุฉ' : 'ููุฏ ุงูุฅูุฌุงุฒ';
                
                content += `
                    <tr>
                        <td>${item.stage}</td>
                        <td>${item.subject}</td>
                        <td>${item.grade}</td>
                        <td>${item.teacher}</td>
                        <td>${item.creationDate || 'ุบูุฑ ูุญุฏุฏ'}</td>
                        <td>${item.updateDate || 'ุบูุฑ ูุญุฏุฏ'}</td>
                        <td>${completionRate}%</td>
                        <td>${status}</td>
                    </tr>
                `;
            });
            
            content += '</table></body></html>';
            
            const blob = new Blob([content], { type: 'application/msword' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'ุชูุฑูุฑ_ุดุงูู_ุฎุฑุงุฆุท_ููุงุชุฌ_ุงูุชุนูู.doc';
            a.click();
            URL.revokeObjectURL(url);
        }

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            updateDateTime();
            setInterval(updateDateTime, 1000); // Update every second
            setCurrentDate();
            updateTeacherDropdowns();
            showSection('elementary');
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'96fb835621de520b',t:'MTc1NTI5MDQ4OS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
